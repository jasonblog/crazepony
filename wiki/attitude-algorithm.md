
姿態解算的英文是attitude algorithm，也叫做姿態分析，姿態估計，姿態融合。姿態解算是指把陀螺儀、加速度計、羅盤等的數據融合在一起，得出飛行器的空中姿態。

飛行器從陀螺儀的三軸角速度通過四元數法得到的俯仰、偏航和滾轉角，這是**快速解算**，結合三軸地磁和三軸加速度得到**漂移補償**和**深度解算**。

## 數學模型
姿態是用來描述一個剛體的固連座標系和參考座標系之間的角位置關係，有一些數學表示方法。很常見的就是歐拉角，四元數，矩陣，軸角。

姿態解算需要解決的是四軸飛行器和地球的相對姿態問題。地球的座標系又叫做**地理座標系**，是固定不變的。正北，正東，正向上構成了這個座標系的X，Y，Z軸，我們用座標系R表示。四軸飛行器上固定著一個座標系，用座標系r表示。那麼我們就可以用歐拉角，四元數等來描述r和R的角位置關係。這就是四軸飛行器姿態解算的數學模型和基礎。

![](/assets/img/earth-coodinate.png)

## 角位置關係測量
如上所說，地球座標系R是固定的。四軸飛行器上固定一個座標系r，這個座標系r在座標系R中運動。那麼如何知道座標系r和座標系R的角位置關係呢，也就是怎麼知道飛行器相對於地球這個固定座標系R轉動了一下航向，或者側翻了一下機身，或者掉頭下栽。這就是傳感器需要測量的數據，傳感器包括陀螺儀，加速度計，磁力計。通過獲得這些測量數據，得到座標系r和座標系R的角位置關係，這就是姿態解算。
